!function(a,b){"use strict";if("object"==typeof exports)module.exports=b(require("d3"));else if("function"==typeof define&&define.amd)define(["d3"],function(c){return a.dimple=b(c),a.dimple});else if(a.d3)a.dimple=b(a.d3);else{if(!console||!console.warn)throw"dimple requires d3 to run.  Are you missing a reference to the d3 library?";console.warn("dimple requires d3 to run.  Are you missing a reference to the d3 library?")}}(this,function(a){"use strict";var b={version:"2.0.5",plot:{},aggregateMethod:{}};return b.axis=function(c,d,e,f,g){this.chart=c,this.position=d,this.categoryFields=null===g||void 0===g?e:[].concat(g),this.measure=f,this.timeField=g,this.floatingBarWidth=5,this.hidden=!1,this.showPercent=!1,this.colors=null,this.overrideMin=null,this.overrideMax=null,this.shapes=null,this.showGridlines=null,this.gridlineShapes=null,this.titleShape=null,this.dateParseFormat=null,this.tickFormat=null,this.timePeriod=null,this.timeInterval=1,this.useLog=!1,this.logBase=10,this.title=void 0,this.clamp=!0,this.ticks=null,this.fontSize="10px",this.fontFamily="sans-serif",this._slaves=[],this._scale=null,this._min=0,this._max=0,this._previousOrigin=null,this._origin=null,this._orderRules=[],this._groupOrderRules=[],this._draw=null,this._getAxisData=function(){var a,b,c=[],d=!1;if(this.chart&&this.chart.series){for(a=0;a<this.chart.series.length;a+=1)b=this.chart.series[a],b[this.position]===this&&(b.data&&b.data.length>0?c=c.concat(b.data):d=!0);d&&this.chart.data&&(c=c.concat(this.chart.data))}return c},this._getFontSize=function(){var a;return a=this.fontSize&&"auto"!==this.fontSize.toString().toLowerCase()?isNaN(this.fontSize)?this.fontSize:this.fontSize+"px":(this.chart._heightPixels()/35>10?this.chart._heightPixels()/35:10)+"px"},this._getFormat=function(){var b,c,d,e,f,g,h;return null!==this.tickFormat&&void 0!==this.tickFormat?b="function"==typeof this.tickFormat?this.tickFormat:this._hasTimeField()?a.time.format(this.tickFormat):a.format(this.tickFormat):this.showPercent?b=a.format("%"):this.useLog&&null!==this.measure?b=function(b){var c=Math.floor(Math.abs(b),0).toString().length,d=Math.min(Math.floor((c-1)/3),4),e="kmBT".substring(d-1,d),f="0"===Math.round(b/Math.pow(1e3,d)*10).toString().slice(-1)?0:1;return 0===b?0:a.format(",."+f+"f")(b/Math.pow(1e3,d))+e}:null!==this.measure?(c=Math.floor(Math.abs(this._max),0).toString(),d=Math.floor(Math.abs(this._min),0).toString(),e=Math.max(d.length,c.length),e>3?(f=Math.min(Math.floor((e-1)/3),4),g="kmBT".substring(f-1,f),h=1>=e-3*f?1:0,b=function(b){return 0===b?0:a.format(",."+h+"f")(b/Math.pow(1e3,f))+g}):(h=1>=e?1:0,b=a.format(",."+h+"f"))):b=function(a){return a},b},this._getTimePeriod=function(){var b=this.timePeriod,c=30,d=this._max-this._min;return this._hasTimeField()&&!this.timePeriod&&(b=c>=d/1e3?a.time.seconds:c>=d/6e4?a.time.minutes:c>=d/36e5?a.time.hours:c>=d/864e5?a.time.days:c>=d/6048e5?a.time.weeks:c>=d/26298e5?a.time.months:a.time.years),b},this._getTooltipText=function(a,b){if(this._hasTimeField())b[this.position+"Field"][0]&&a.push(this.timeField+": "+this._getFormat()(b[this.position+"Field"][0]));else if(this._hasCategories())this.categoryFields.forEach(function(c,d){null!==c&&void 0!==c&&b[this.position+"Field"][d]&&a.push(c+(b[this.position+"Field"][d]!==c?": "+b[this.position+"Field"][d]:""))},this);else if(this._hasMeasure())switch(this.position){case"x":a.push(this.measure+": "+this._getFormat()(b.width));break;case"y":a.push(this.measure+": "+this._getFormat()(b.height));break;case"z":a.push(this.measure+": "+this._getFormat()(b.zValue));break;case"c":a.push(this.measure+": "+this._getFormat()(b.cValue))}},this._getTopMaster=function(){var a=this;return null!==this.master&&void 0!==this.master&&(a=this.master._getTopMaster()),a},this._hasCategories=function(){return null!==this.categoryFields&&void 0!==this.categoryFields&&this.categoryFields.length>0},this._hasMeasure=function(){return null!==this.measure&&void 0!==this.measure},this._hasTimeField=function(){return null!==this.timeField&&void 0!==this.timeField},this._parseDate=function(b){var c;return c=null===this.dateParseFormat||void 0===this.dateParseFormat?isNaN(b)?Date.parse(b):new Date(b):a.time.format(this.dateParseFormat).parse(b)},this._update=function(c){var d,e,f,g,h,i=[],j=this.ticks||10,k=function(a,c,d){var e,f,g=a.categoryFields[0],h=a._getAxisData(),i=g,j=!1,k=!0,l=null;for(e=0;e<h.length;e+=1)if(l=a._parseDate(h[e][g]),null!==l&&void 0!==l&&isNaN(l)){k=!1;break}return k||a.chart.series.forEach(function(b){b[c]===a&&b[d]._hasMeasure()&&(i=b[d].measure,j=!0)},this),f=a._orderRules.concat({ordering:i,desc:j}),b._getOrderedList(h,g,f)};if(this._min=this.showPercent&&this._min<-1?-1:this._min,this._max=this.showPercent&&this._max>1?1:this._max,this._min=null!==this.overrideMin?this.overrideMin:this._min,this._max=null!==this.overrideMax?this.overrideMax:this._max,this._min>this._max&&(this._min=this._max),"x"!==this.position||null!==this._scale&&!c){if("y"!==this.position||null!==this._scale&&!c)this.position.length>0&&"z"===this.position[0]&&null===this._scale?this._scale=this.useLog?a.scale.log().range([this.chart._heightPixels()/300,this.chart._heightPixels()/10]).domain([0===this._min?Math.pow(this.logBase,-1):this._min,0===this._max?-1*Math.pow(this.logBase,-1):this._max]).clamp(this.clamp).base(this.logBase):a.scale.linear().range([1,this.chart._heightPixels()/10]).domain([this._min,this._max]).clamp(this.clamp):this.position.length>0&&"c"===this.position[0]&&null===this._scale&&(this._scale=a.scale.linear().range([0,null===this.colors||1===this.colors.length?1:this.colors.length-1]).domain([this._min,this._max]).clamp(this.clamp));else if(this._hasTimeField()?this._scale=a.time.scale().rangeRound([this.chart._yPixels()+this.chart._heightPixels(),this.chart._yPixels()]).domain([this._min,this._max]).clamp(this.clamp):this.useLog?this._scale=a.scale.log().range([this.chart._yPixels()+this.chart._heightPixels(),this.chart._yPixels()]).domain([0===this._min?Math.pow(this.logBase,-1):this._min,0===this._max?-1*Math.pow(this.logBase,-1):this._max]).clamp(this.clamp).base(this.logBase).nice():null===this.measure||void 0===this.measure?(i=k(this,"y","x"),null!==this._slaves&&void 0!==this._slaves&&this._slaves.forEach(function(a){i=i.concat(k(a,"y","x"))},this),this._scale=a.scale.ordinal().rangePoints([this.chart._yPixels()+this.chart._heightPixels(),this.chart._yPixels()]).domain(i.concat([""]))):this._scale=a.scale.linear().range([this.chart._yPixels()+this.chart._heightPixels(),this.chart._yPixels()]).domain([this._min,this._max]).clamp(this.clamp).nice(),!this.hidden)switch(this.chart._axisIndex(this,"y")){case 0:this._draw=a.svg.axis().orient("left").scale(this._scale),this.ticks&&this._draw.ticks(j);break;case 1:this._draw=a.svg.axis().orient("right").scale(this._scale),this.ticks&&this._draw.ticks(j)}}else if(this._hasTimeField()?(h=0,isNaN(this.floatingBarWidth)||(h=this.floatingBarWidth/2),this._scale=a.time.scale().rangeRound([this.chart._xPixels()+h,this.chart._xPixels()+this.chart._widthPixels()]).domain([this._min,this._max]).clamp(this.clamp)):this.useLog?this._scale=a.scale.log().range([this.chart._xPixels(),this.chart._xPixels()+this.chart._widthPixels()]).domain([0===this._min?Math.pow(this.logBase,-1):this._min,0===this._max?-1*Math.pow(this.logBase,-1):this._max]).clamp(this.clamp).base(this.logBase).nice():null===this.measure||void 0===this.measure?(i=k(this,"x","y"),null!==this._slaves&&void 0!==this._slaves&&this._slaves.forEach(function(a){i=i.concat(k(a,"x","y"))},this),this._scale=a.scale.ordinal().rangeBands([this.chart._xPixels(),this.chart._xPixels()+this.chart._widthPixels()]).domain(i)):this._scale=a.scale.linear().range([this.chart._xPixels(),this.chart._xPixels()+this.chart._widthPixels()]).domain([this._min,this._max]).clamp(this.clamp).nice(),!this.hidden)switch(this.chart._axisIndex(this,"x")){case 0:this._draw=a.svg.axis().orient("bottom").scale(this._scale),this.ticks&&this._draw.ticks(this.ticks),this.tickValues&&this._draw.tickValues(this.tickValues);break;case 1:this._draw=a.svg.axis().orient("top").scale(this._scale),this.ticks&&this._draw.ticks(j)}return null!==this._slaves&&void 0!==this._slaves&&this._slaves.length>0&&this._slaves.forEach(function(a){a._scale=this._scale},this),null!==c&&void 0!==c&&c!==!1||this._hasTimeField()||null===this._scale||null===this._scale.ticks||void 0===this._scale.ticks||!(this._scale.ticks(j).length>0)||"x"!==this.position&&"y"!==this.position||(d=this._scale.ticks(j),e=d[1]-d[0],f=((this._max-this._min)%e).toFixed(0),0!==f&&(this._max=Math.ceil(this._max/e)*e,this._min=Math.floor(this._min/e)*e,this._update(!0))),g=this._scale.copy()(null!==i&&void 0!==i&&i.length>0?i[0]:this._min>0?this._min:this._max<0?this._max:0),this._origin!==g&&(this._previousOrigin=null===this._origin?g:this._origin,this._origin=g),this},this.addGroupOrderRule=function(a,b){this._groupOrderRules.push({ordering:a,desc:b})},this.addOrderRule=function(a,b){this._orderRules.push({ordering:a,desc:b})}},b.chart=function(c,d){this.svg=c,this.x="10%",this.y="10%",this.width="80%",this.height="80%",this.data=d,this.noFormats=!1,this.axes=[],this.series=[],this.legends=[],this.storyboard=null,this.titleShape=null,this.shapes=null,this.ease="cubic-in-out",this.staggerDraw=!1,this._group=c.append("g"),this._tooltipGroup=null,this._assignedColors={},this._nextColor=0,this._axisIndex=function(a,b){var c=0,d=0,e=-1;for(c=0;c<this.axes.length;c+=1){if(this.axes[c]===a){e=d;break}(null===b||void 0===b||b[0]===this.axes[c].position[0])&&(d+=1)}return e},this._getAllData=function(){var a=[];return null!==this.data&&void 0!==this.data&&this.data.length>0&&(a=a.concat(this.data)),null!==this.series&&void 0!==this.series&&this.series.length>0&&this.series.forEach(function(b){null!==b.data&&void 0!==b.data&&b.data.length>0&&(a=a.concat(b.data))}),a},this._getDelay=function(a,c,d){return function(e){var f=0;return d&&c.staggerDraw&&(d.x._hasCategories()?f=b._helpers.cx(e,c,d)/c._widthPixels()*a:d.y._hasCategories()&&(f=(1-b._helpers.cy(e,c,d)/c._heightPixels())*a)),f}},this._getSeriesData=function(){null!==this.series&&void 0!==this.series&&this.series.forEach(function(c){var d,e,f=[],g=function(a,b){var c=[];return null!==a&&(a._hasTimeField()?c.push(a._parseDate(b[a.timeField])):a._hasCategories()&&a.categoryFields.forEach(function(a){c.push(b[a])},this)),c},h={x:!1,y:!1,z:!1,c:!1},i={x:[],y:[]},j={x:[],y:[],z:[]},k={min:null,max:null},l={x:[],y:[],z:[]},m=[],n={},o={x:0,y:0,z:0},p="",q=[],r=[],s=[],t="",u=[],v="",w=[],x=[],y=c.data||this.data||[],z=[];null!==this.storyboard&&void 0!==this.storyboard&&this.storyboard.categoryFields.length>0&&(p=this.storyboard.categoryFields[0],q=b._getOrderedList(y,p,this.storyboard._orderRules)),c.x._hasCategories()&&c.x._hasMeasure()&&(t=c.x.categoryFields[0],u=b._getOrderedList(y,t,c.x._orderRules.concat([{ordering:c.x.measure,desc:!0}]))),c.y._hasCategories()&&c.y._hasMeasure()&&(v=c.y.categoryFields[0],w=b._getOrderedList(y,v,c.y._orderRules.concat([{ordering:c.y.measure,desc:!0}]))),y.length>0&&null!==c.categoryFields&&void 0!==c.categoryFields&&c.categoryFields.length>0&&(x=[].concat(c._orderRules),r=[],c.categoryFields.forEach(function(a){void 0!==y[0][a]&&r.push(a)},this),null!==c.c&&void 0!==c.c&&c.c._hasMeasure()?x.push({ordering:c.c.measure,desc:!0}):null!==c.z&&void 0!==c.z&&c.z._hasMeasure()?x.push({ordering:c.z.measure,desc:!0}):c.x._hasMeasure()?x.push({ordering:c.x.measure,desc:!0}):c.y._hasMeasure()&&x.push({ordering:c.y.measure,desc:!0}),s=b._getOrderedList(y,r,x)),y.sort(function(a,b){var c,d,e,f,g,h,i=0;if(""!==p&&(i=q.indexOf(a[p])-q.indexOf(b[p])),""!==t&&0===i&&(i=u.indexOf(a[t])-u.indexOf(b[t])),""!==v&&0===i&&(i=w.indexOf(a[v])-w.indexOf(b[v])),r&&r.length>0&&0===i)for(c=[].concat(r),i=0,e=0;e<s.length;e+=1){for(d=[].concat(s[e]),g=!0,h=!0,f=0;f<c.length;f+=1)g=g&&a[c[f]]===d[f],h=h&&b[c[f]]===d[f];if(g&&h){i=0;break}if(g){i=-1;break}if(h){i=1;break}}return i}),y.forEach(function(a){var b,d,e,i,j,k=-1,l=g(c.x,a),m=g(c.y,a),n=g(c.z,a),o=[];if(null===c.categoryFields||void 0===c.categoryFields||0===c.categoryFields.length)o=["All"];else for(e=0;e<c.categoryFields.length;e+=1)o.push(void 0===a[c.categoryFields[e]]?c.categoryFields[e]:a[c.categoryFields[e]]);for(b=o.join("/")+"_"+l.join("/")+"_"+m.join("/")+"_"+n.join("/"),d=0;d<f.length;d+=1)if(f[d].key===b){k=d;break}-1===k&&(i={key:b,aggField:o,xField:l,xValue:null,xCount:0,yField:m,yValue:null,yCount:0,zField:n,zValue:null,zCount:0,cValue:0,cCount:0,x:0,y:0,xOffset:0,yOffset:0,width:0,height:0,cx:0,cy:0,xBound:0,yBound:0,xValueList:[],yValueList:[],zValueList:[],cValueList:[],fill:{},stroke:{},origData:a},f.push(i),k=f.length-1),j=function(b,d){var e,g,i=!0,j={value:0,count:1},l={value:0,count:1},m="";null!==d&&(e=d.getFrameValue(),d.categoryFields.forEach(function(b,c){c>0&&(m+="/"),m+=a[b],i=m===e},this)),null!==b&&void 0!==b&&i&&(g=f[k],b._hasMeasure()&&null!==a[b.measure]&&void 0!==a[b.measure]&&(-1===g[b.position+"ValueList"].indexOf(a[b.measure])&&g[b.position+"ValueList"].push(a[b.measure]),isNaN(parseFloat(a[b.measure]))&&(h[b.position]=!0),j.value=g[b.position+"Value"],j.count=g[b.position+"Count"],l.value=a[b.measure],g[b.position+"Value"]=c.aggregate(j,l),g[b.position+"Count"]+=1))},j(c.x,this.storyboard),j(c.y,this.storyboard),j(c.z,this.storyboard),j(c.c,this.storyboard)},this),null!==c.x&&void 0!==c.x&&c.x._hasCategories()&&c.x.categoryFields.length>1&&void 0!==i.x&&(z=[],c.y._hasMeasure()&&z.push({ordering:c.y.measure,desc:!0}),i.x=b._getOrderedList(y,c.x.categoryFields[1],c.x._groupOrderRules.concat(z))),null!==c.y&&void 0!==c.y&&c.y._hasCategories()&&c.y.categoryFields.length>1&&void 0!==i.y&&(z=[],c.x._hasMeasure()&&z.push({ordering:c.x.measure,desc:!0}),i.y=b._getOrderedList(y,c.y.categoryFields[1],c.y._groupOrderRules.concat(z)),i.y.reverse()),f.forEach(function(a){null!==c.x&&(h.x===!0&&(a.xValue=a.xValueList.length),d=(null===j.x[a.xField.join("/")]||void 0===j.x[a.xField.join("/")]?0:j.x[a.xField.join("/")])+(c.y._hasMeasure()?Math.abs(a.yValue):0),j.x[a.xField.join("/")]=d),null!==c.y&&(h.y===!0&&(a.yValue=a.yValueList.length),d=(null===j.y[a.yField.join("/")]||void 0===j.y[a.yField.join("/")]?0:j.y[a.yField.join("/")])+(c.x._hasMeasure()?Math.abs(a.xValue):0),j.y[a.yField.join("/")]=d),null!==c.z&&(h.z===!0&&(a.zValue=a.zValueList.length),d=(null===j.z[a.zField.join("/")]||void 0===j.z[a.zField.join("/")]?0:j.z[a.zField.join("/")])+(c.z._hasMeasure()?Math.abs(a.zValue):0),j.z[a.zField.join("/")]=d),null!==c.c&&((null===k.min||a.cValue<k.min)&&(k.min=a.cValue),(null===k.max||a.cValue>k.max)&&(k.max=a.cValue))},this);for(e in j.x)j.x.hasOwnProperty(e)&&(o.x+=j.x[e]);for(e in j.y)j.y.hasOwnProperty(e)&&(o.y+=j.y[e]);for(e in j.z)j.z.hasOwnProperty(e)&&(o.z+=j.z[e]);f.forEach(function(b){var d,e,f,g,h,p,q={},r=null,s=[],t=0,u=function(a,d,e){var f,g,h,k,u,v;if(null!==a&&void 0!==a)if(k=a.position,a._hasCategories()){if(a._hasMeasure())f=b[a.position+"Field"].join("/"),g=a.showPercent?j[a.position][f]/o[a.position]:j[a.position][f],-1===m.indexOf(f)&&(n[f]=g+(m.length>0?n[m[m.length-1]]:0),m.push(f)),h=b[k+"Bound"]=b["c"+k]="x"!==k&&"y"!==k||!c._isStacked()?g:n[f],b[e]=g,b[k]=h-("x"===k&&g>=0||"y"===k&&0>=g?g:0);else if(b[k]=b["c"+k]=b[k+"Field"][0],b[e]=1,void 0!==i[k]&&null!==i[k]&&i[k].length>=2){p=_.first(c.x.categoryFields),q[p]=b[k+"Field"][0],_.where(y,q).map(function(a){s.push(a[c.x.categoryFields[1]])}),r=_.groupBy(y,function(a){return a[p]});for(u in r)r.hasOwnProperty(u)&&(t=Math.max(r[u].length,t));b[k+"Offset"]=s.length<t?s.indexOf(b[k+"Field"][1])+(t-s.length)/2:s.indexOf(b[k+"Field"][1]),b[e]=1/t}}else g=a.showPercent?b[k+"Value"]/j[d][b[d+"Field"].join("/")]:b[k+"Value"],f=b[d+"Field"].join("/")+(b[k+"Value"]>=0),v=l[k][f]=(null===l[k][f]||void 0===l[k][f]||"z"===k?0:l[k][f])+g,h=b[k+"Bound"]=b["c"+k]="x"!==k&&"y"!==k||!c._isStacked()?g:v,b[e]=g,b[k]=h-("x"===k&&g>=0||"y"===k&&0>=g?g:0)};u(c.x,"y","width"),u(c.y,"x","height"),u(c.z,"z","r"),null!==c.c&&null!==k.min&&null!==k.max&&(k.min===k.max&&(k.min-=.5,k.max+=.5),k.min=null!==c.c.overrideMin&&void 0!==c.c.overrideMin?c.c.overrideMin:k.min,k.max=null!==c.c.overrideMax&&void 0!==c.c.overrideMax?c.c.overrideMax:k.max,b.cValue=b.cValue>k.max?k.max:b.cValue<k.min?k.min:b.cValue,f=a.scale.linear().range([0,null===c.c.colors||1===c.c.colors.length?1:c.c.colors.length-1]).domain([k.min,k.max]),g=f(b.cValue),h=g-Math.floor(g),b.cValue===k.max&&(h=1),null!==c.c.colors&&void 0!==c.c.colors&&1===c.c.colors.length?(d=a.rgb(c.c.colors[0]),e=a.rgb(this.getColor(b.aggField.slice(-1)[0]).fill)):null!==c.c.colors&&void 0!==c.c.colors&&c.c.colors.length>1?(d=a.rgb(c.c.colors[Math.floor(g)]),e=a.rgb(c.c.colors[Math.ceil(g)])):(d=a.rgb("white"),e=a.rgb(this.getColor(b.aggField.slice(-1)[0]).fill)),d.r=Math.floor(d.r+(e.r-d.r)*h),d.g=Math.floor(d.g+(e.g-d.g)*h),d.b=Math.floor(d.b+(e.b-d.b)*h),b.fill=d.toString(),b.stroke=d.darker(.5).toString())},this),c._positionData=f},this)},this._handleTransition=function(a,b,c,d){var e=null;return e=0===b?a:a.transition().duration(b).delay(c._getDelay(b,c,d)).ease(c.ease)},this._heightPixels=function(){return b._parseYPosition(this.height,this.svg.node())},this._registerEventHandlers=function(c){null!==c._eventHandlers&&c._eventHandlers.length>0&&c._eventHandlers.forEach(function(d){var e=null;null!==d.handler&&"function"==typeof d.handler&&(e=null!==c._markers&&void 0!==c._markers?c._markers:c.shapes,e.on(d.event,function(e){var f=new b.eventArgs;null!==c.chart.storyboard&&(f.frameValue=c.chart.storyboard.getFrameValue()),f.seriesValue=e.aggField,f.xValue=e.x,f.yValue=e.y,f.zValue=e.z,f.colorValue=e.cValue,f.seriesShapes=c.shapes,f.selectedShape=a.select(this),d.handler(f)}))},this)},this._widthPixels=function(){return b._parseXPosition(this.width,this.svg.node())},this._xPixels=function(){return b._parseXPosition(this.x,this.svg.node())},this._yPixels=function(){return b._parseYPosition(this.y,this.svg.node())},this.addAxis=function(a,c,d,e){var f=null,g=null;if(null!==c&&void 0!==c&&(c=[].concat(c)),"string"==typeof a||a instanceof String)f=new b.axis(this,a,c,d,e),this.axes.push(f);else{if(g=a,f=new b.axis(this,g.position,c,d,e),f._hasMeasure()!==g._hasMeasure())throw"You have specified a composite axis where some but not all axes have a measure - this is not supported, all axes must be of the same type.";if(f._hasTimeField()!==g._hasTimeField())throw"You have specified a composite axis where some but not all axes have a time field - this is not supported, all axes must be of the same type.";if((null===f.categoryFields||void 0===f.categoryFields?0:f.categoryFields.length)!==(null===g.categoryFields||void 0===g.categoryFields?0:g.categoryFields.length))throw"You have specified a composite axis where axes have differing numbers of category fields - this is not supported, all axes must be of the same type.";g._slaves.push(f)}return f},this.addCategoryAxis=function(a,b){return this.addAxis(a,b,null)},this.addColorAxis=function(a,b){var c=this.addAxis("c",null,a);return c.colors=null===b||void 0===b?null:[].concat(b),c},this.addLegend=function(a,c,d,e,f,g){g=null===g||void 0===g?this.series:[].concat(g),f=null===f||void 0===f?"left":f;var h=new b.legend(this,a,c,d,e,f,g);return this.legends.push(h),h},this.addLogAxis=function(a,b,c){var d=this.addAxis(a,null,b,null);return null!==c&&void 0!==c&&(d.logBase=c),d.useLog=!0,d},this.addMeasureAxis=function(a,b){return this.addAxis(a,null,b)},this.addPctAxis=function(a,b,c){var d=null;return d=null!==c&&void 0!==c?this.addAxis(a,c,b):this.addMeasureAxis(a,b),d.showPercent=!0,d},this.addSeries=function(a,c,d){(null===d||void 0===d)&&(d=this.axes),(null===c||void 0===c)&&(c=b.plot.bubble);var e,f=null,g=null,h=null,i=null;return d.forEach(function(a){null!==a&&c.supportedAxes.indexOf(a.position)>-1&&(null===f&&"x"===a.position[0]?f=a:null===g&&"y"===a.position[0]?g=a:null===h&&"z"===a.position[0]?h=a:null===i&&"c"===a.position[0]&&(i=a))},this),null!==a&&void 0!==a&&(a=[].concat(a)),e=new b.series(this,a,f,g,h,i,c,b.aggregateMethod.sum,c.stacked),this.series.push(e),e},this.addTimeAxis=function(a,b,c,d){var e=this.addAxis(a,null,null,b);return e.tickFormat=d,e.dateParseFormat=c,e},this.assignColor=function(a,c,d,e){return this._assignedColors[a]=new b.color(c,d,e),this._assignedColors[a]},this.defaultColors=[new b.color("#80B1D3"),new b.color("#FB8072"),new b.color("#FDB462"),new b.color("#B3DE69"),new b.color("#FFED6F"),new b.color("#BC80BD"),new b.color("#8DD3C7"),new b.color("#CCEBC5"),new b.color("#FFFFB3"),new b.color("#BEBADA"),new b.color("#FCCDE5"),new b.color("#D9D9D9")],this.draw=function(c,d){c=null===c||void 0===c?0:c;var e,f,g=null,h=null,i=!1,j=!1,k=this._xPixels(),l=this._yPixels(),m=this._widthPixels(),n=this._heightPixels();return(void 0===d||null===d||d===!1)&&this._getSeriesData(),this.axes.forEach(function(a){a._scale=null},this),this.axes.forEach(function(a){if(a._min=0,a._max=0,f=[],a._hasMeasure()){var b=!1;this.series.forEach(function(c){if(c._deepMatch(a)){var d=c._axisBounds(a.position);a._min>d.min&&(a._min=d.min),a._max<d.max&&(a._max=d.max),b=!0}},this),b||this._getAllData().forEach(function(b){a._min>b[a.measure]&&(a._min=b[a.measure]),a._max<b[a.measure]&&(a._max=b[a.measure])},this)}else a._hasTimeField()?(a._min=null,a._max=null,this.series.forEach(function(b){b._deepMatch(a)&&null!==b[a.position].timeField&&void 0!==b[a.position].timeField&&-1===f.indexOf(b[a.position].timeField)&&f.push(b[a.position].timeField)},this),a._getAxisData().forEach(function(b){f.forEach(function(c){var d=a._parseDate(b[c]);(null===a._min||d<a._min)&&(a._min=d),(null===a._max||d>a._max)&&(a._max=d)},this)},this)):a._hasCategories()&&(a._min=0,e=[],this.series.forEach(function(b){b._deepMatch(a)&&null!==b[a.position].categoryFields[0]&&void 0!==b[a.position].categoryFields[0]&&-1===f.indexOf(b[a.position].categoryFields[0])&&f.push(b[a.position].categoryFields[0])},this),a._getAxisData().forEach(function(a){f.forEach(function(b){-1===e.indexOf(a[b])&&e.push(a[b])},this)},this),a._max=e.length);null!==a._slaves&&void 0!==a._slaves&&a._slaves.length>0&&a._slaves.forEach(function(b){b._min=a._min,b._max=a._max},this),a._update(),null===g&&"x"===a.position?g=a:null===h&&"y"===a.position&&(h=a)},this),this.axes.forEach(function(d){var e,f,o,p=!1,q=null,r=0,s=null,t=!1,u=0,v={l:null,t:null,r:null,b:null},w=0,x=0,y="",z=this,A=!1,B=function(a){var b;return b=null===q||0===c||p?a:z._handleTransition(a,c,z)},C=function(){d.measure||"y"===d.position&&a.select(this).selectAll("text").attr("y",-1*(n/d._max)/2),d.categoryFields&&d.categoryFields.length>0&&(d!==g||null!==h.categoryFields&&0!==h.categoryFields.length||a.select(this).selectAll("text").attr("y",l+n-h._scale(0)+9),d!==h||null!==g.categoryFields&&0!==g.categoryFields.length||a.select(this).selectAll("text").attr("x",-1*(g._scale(0)-k)-9))};null===d.gridlineShapes?(d.showGridlines||null===d.showGridlines&&!d._hasCategories()&&(!i&&"x"===d.position||!j&&"y"===d.position))&&(d.gridlineShapes=this._group.append("g").attr("class","dimple-gridline"),"x"===d.position?i=!0:j=!0):"x"===d.position?i=!0:j=!0,null===d.shapes&&(d.shapes=this._group.append("g").attr("class","dimple-axis"),p=!0),d===g&&null!==h?(q="translate(0, "+(null===h.categoryFields||0===h.categoryFields.length?h._scale(0):l+n)+")",s="translate(0, "+(d===g?l+n:l)+")",r=-n):d===h&&null!==g?(q="translate("+(null===g.categoryFields||0===g.categoryFields.length?g._scale(0):k)+", 0)",s="translate("+(d===h?k:k+m)+", 0)",r=-m):"x"===d.position?(s=q="translate(0, "+(d===g?l+n:l)+")",r=-n):"y"===d.position&&(s=q="translate("+(d===h?k:k+m)+", 0)",r=-m),null!==q&&null!==d._draw&&(d._hasTimeField()?B(d.shapes).call(d._draw.ticks(d._getTimePeriod(),d.timeInterval).tickFormat(d._getFormat())).attr("transform",q).each(C):d.useLog?B(d.shapes).call(d._draw.ticks(4,d._getFormat())).attr("transform",q).each(C):B(d.shapes).call(d._draw.tickFormat(d._getFormat())).attr("transform",q).each(C),null!==d.gridlineShapes&&B(d.gridlineShapes).call(d._draw.tickSize(r,0,0).tickFormat("")).attr("transform",s)),(null===d.measure||void 0===d.measure)&&(e=m/d._getAxisData().length-4,o=d._getAxisData()[0],void 0!==o&&void 0!==o.date&&void 0!==o.dateTime&&(A=!0),d===g?(u=0,d.shapes.selectAll("text").each(function(){var a=this.getComputedTextLength();u=a>u?a:u}),f=b._helpers.leaveEveryNth(d.shapes.selectAll("text")[0].length,u,m),u>m/d.shapes.selectAll("text")[0].length||f>1?(t=!0,d.shapes.selectAll("text").style("text-anchor","middle").each(function(b,c){if(d._hasTimeField()||A)c%f!==0&&a.select(this.parentNode).style("opacity",0);else{var e=this.getBBox();a.select(this).attr("transform","rotate(45) translate("+(e.width/2+5)+", 0)")}})):(t=!1,d.shapes.selectAll("text").style("text-anchor","middle").attr("transform",""))):"x"===d.position&&(u=0,d.shapes.selectAll("text").each(function(){var a=this.getComputedTextLength();u=a>u?a:u}),u>m/d.shapes.selectAll("text")[0].length?(t=!0,d.shapes.selectAll("text").style("text-anchor","end").each(function(b,c){if(d._hasTimeField()||A)c%f!==0&&a.select(this).attr("opacity",0);else{var e=this.getBBox();a.select(this).attr("transform","rotate(45) translate("+(e.width/2+5)+", 0)")}})):(t=!1,d.shapes.selectAll("text").style("text-anchor","middle").attr("transform","")))),null!==d.titleShape&&void 0!==d.titleShape&&d.titleShape.remove(),d.shapes.selectAll("text").each(function(){var a=this.getBBox();(null===v.l||-9-a.width<v.l)&&(v.l=-9-a.width),(null===v.r||a.x+a.width>v.r)&&(v.r=a.x+a.width),t?((null===v.t||a.y+a.height-a.width<v.t)&&(v.t=a.y+a.height-a.width),(null===v.b||a.height+a.width>v.b)&&(v.b=a.height+a.width)):((null===v.t||a.y<v.t)&&(v.t=a.y),(null===v.b||9+a.height>v.b)&&(v.b=9+a.height))}),"x"===d.position?(x=d===g?l+n+v.b+5:l+v.t-10,w=k+m/2):"y"===d.position&&(w=d===h?k+v.l-10:k+m+v.r+20,x=l+n/2,y="rotate(270, "+w+", "+x+")"),d.hidden||"x"!==d.position&&"y"!==d.position||null===d.title||(d.titleShape=this._group.append("text").attr("class","dimple-axis dimple-title"),d.titleShape.attr("x",w).attr("y",x).attr("text-anchor","middle").attr("transform",y).text(void 0!==d.title?d.title:null===d.categoryFields||void 0===d.categoryFields||0===d.categoryFields.length?d.measure:d.categoryFields.join("/")),d===g?d.titleShape.each(function(){a.select(this).attr("y",x+this.getBBox().height/1.65)}):d===h&&d.titleShape.each(function(){a.select(this).attr("x",w+this.getBBox().height/1.65)}))},this),this.series.forEach(function(a){a.plot.draw(this,a,c),this._registerEventHandlers(a)},this),this.legends.forEach(function(a){a._draw(c)},this),null!==this.storyboard&&void 0!==this.storyboard&&(this.storyboard._drawText(),this.storyboard.autoplay&&this.storyboard.startAnimation()),this},this.getColor=function(a){return(null===this._assignedColors[a]||void 0===this._assignedColors[a])&&(this._assignedColors[a]=this.defaultColors[this._nextColor],this._nextColor=(this._nextColor+1)%this.defaultColors.length),this._assignedColors[a]},this.setBounds=function(a,c,d,e){return this.x=a,this.y=c,this.width=d,this.height=e,this._xPixels=function(){return b._parseXPosition(this.x,this.svg.node())},this._yPixels=function(){return b._parseYPosition(this.y,this.svg.node())},this._widthPixels=function(){return b._parseXPosition(this.width,this.svg.node())},this._heightPixels=function(){return b._parseYPosition(this.height,this.svg.node())},this.draw(0,!0),this},this.setMargins=function(a,c,d,e){return this.x=a,this.y=c,this.width=0,this.height=0,this._xPixels=function(){return b._parseXPosition(this.x,this.svg.node())},this._yPixels=function(){return b._parseYPosition(this.y,this.svg.node())},this._widthPixels=function(){return b._parentWidth(this.svg.node())-this._xPixels()-b._parseXPosition(d,this.svg.node())},this._heightPixels=function(){return b._parentHeight(this.svg.node())-this._yPixels()-b._parseYPosition(e,this.svg.node())},this.draw(0,!0),this},this.setStoryboard=function(a,c){return this.storyboard=new b.storyboard(this,a),null!==c&&void 0!==c&&(this.storyboard.onTick=c),this.storyboard}},b.color=function(b,c,d){this.fill=b,this.stroke=null===c||void 0===c?a.rgb(b).darker(.5).toString():c,this.opacity=null===d||void 0===d?1:d},b.eventArgs=function(){this.seriesValue=null,this.xValue=null,this.yValue=null,this.zValue=null,this.colorValue=null,this.frameValue=null,this.seriesShapes=null,this.selectedShape=null},b.legend=function(c,d,e,f,g,h,i){this.chart=c,this.series=i,this.x=d,this.y=e,this.width=f,this.height=g,this.horizontalAlign=h,this.shapes=null,this.fontSize="10px",this.fontFamily="sans-serif",this._draw=function(c){var d,e=this._getEntries(),f=0,g=0,h=0,i=0,j=15,k=9,l=this;null!==this.shapes&&void 0!==this.shapes&&this.shapes.transition().duration(.2*c).attr("opacity",0).remove(),d=this.chart._group.selectAll(".dimple-dont-select-any").data(e).enter().append("g").attr("class",function(a){return"dimple-legend "+b._createClass(a.aggField)}).attr("opacity",0),d.append("text").attr("class",function(a){return"dimple-legend dimple-legend-text "+b._createClass(a.aggField)}).text(function(a){return a.key}).each(function(){var a=this.getBBox();a.width>f&&(f=a.width),a.height>g&&(g=a.height)}),d.append("rect").attr("class",function(a){return"dimple-legend dimple-legend-key "+b._createClass(a.aggField)}).attr("height",k).attr("width",j),g=(k>g?k:g)+2,f+=j+20,d.each(function(c){h+f>l._widthPixels()&&(h=0,i+=g),i>l._heightPixels()?a.select(this).remove():(a.select(this).select("text").attr("x","left"===l.horizontalAlign?l._xPixels()+j+5+h:l._xPixels()+(l._widthPixels()-h-f)+j+5).attr("y",function(){return l._yPixels()+i+this.getBBox().height/1.65}).attr("width",l._widthPixels()).attr("height",l._heightPixels()),a.select(this).select("rect").attr("class",function(a){return"dimple-legend dimple-legend-key "+b._createClass(a.aggField)}).attr("x","left"===l.horizontalAlign?l._xPixels()+h:l._xPixels()+(l._widthPixels()-h-f)).attr("y",l._yPixels()+i).attr("height",k).attr("width",j).style("fill",c.fill).style("stroke",c.stroke).style("opacity",c.opacity).style("shape-rendering","crispEdges"),h+=f)}),d.transition().delay(.2*c).duration(.8*c).attr("opacity",1),this.shapes=d},this._getEntries=function(){var a=[];return this.series&&this.series.forEach(function(b){var c=b._positionData;c.forEach(function(c){var d,e=-1,f=b.plot.grouped&&!b.x._hasCategories()&&!b.y._hasCategories()&&c.aggField.length<2?"All":c.aggField.slice(-1)[0];for(d=0;d<a.length;d+=1)if(a[d].key===f){e=d;break}-1===e&&b.chart._assignedColors[f]&&(a.push({key:f,fill:b.chart._assignedColors[f].fill,stroke:b.chart._assignedColors[f].stroke,opacity:b.chart._assignedColors[f].opacity,series:b,aggField:c.aggField}),e=a.length-1)})},this),a},this._getFontSize=function(){var a;return a=this.fontSize&&"auto"!==this.fontSize.toString().toLowerCase()?isNaN(this.fontSize)?this.fontSize:this.fontSize+"px":(this.chart._heightPixels()/35>10?this.chart._heightPixels()/35:10)+"px"},this._heightPixels=function(){return b._parseYPosition(this.height,this.chart.svg.node())},this._widthPixels=function(){return b._parseXPosition(this.width,this.chart.svg.node())},this._xPixels=function(){return b._parseXPosition(this.x,this.chart.svg.node())},this._yPixels=function(){return b._parseYPosition(this.y,this.chart.svg.node())}},b.series=function(a,b,c,d,e,f,g,h,i){this.chart=a,this.x=c,this.y=d,this.z=e,this.c=f,this.plot=g,this.categoryFields=b,this.aggregate=h,this.stacked=i,this.barGap=.2,this.clusterBarGap=.1,this.lineWeight=2,this.lineMarkers=!1,this.afterDraw=null,this.interpolation="linear",this.tooltipFontSize="10px",this.tooltipFontFamily="sans-serif",this.radius="auto",this._eventHandlers=[],this._positionData=[],this._orderRules=[],this._axisBounds=function(a){var b,c,d,e={min:0,max:0},f=null,g=null,h=[],i=0,j=this._positionData;return"x"===a?(f=this.x,g=this.y):"y"===a?(f=this.y,g=this.x):"z"===a?f=this.z:"c"===a&&(f=this.c),f.showPercent?j.forEach(function(a){a[f.position+"Bound"]<e.min&&(e.min=a[f.position+"Bound"]),a[f.position+"Bound"]>e.max&&(e.max=a[f.position+"Bound"])
},this):null===g||null===g.categoryFields||0===g.categoryFields.length?j.forEach(function(a){!this._isStacked()||"x"!==f.position&&"y"!==f.position?(a[f.position+"Value"]<e.min&&(e.min=a[f.position+"Value"]),a[f.position+"Value"]>e.max&&(e.max=a[f.position+"Value"])):a[f.position+"Value"]<0?e.min=e.min+a[f.position+"Value"]:e.max=e.max+a[f.position+"Value"]},this):(b=f.position+"Value",c=g.position+"Field",d=[],j.forEach(function(a){var e=a[c].join("/"),f=d.indexOf(e);-1===f&&(d.push(e),f=d.length-1),void 0===h[f]&&(h[f]={min:0,max:0},f>=i&&(i=f+1)),this.stacked?a[b]<0?h[f].min=h[f].min+a[b]:h[f].max=h[f].max+a[b]:(a[b]<h[f].min&&(h[f].min=a[b]),a[b]>h[f].max&&(h[f].max=a[b]))},this),h.forEach(function(a){void 0!==a&&(a.min<e.min&&(e.min=a.min),a.max>e.max&&(e.max=a.max))},this)),e},this._deepMatch=function(a){var b=!1;return this[a.position]===a?b=!0:void 0!==a._slaves&&null!==a._slaves&&a._slaves.length>0&&a._slaves.forEach(function(a){b=b||this._deepMatch(a)},this),b},this._dropLineOrigin=function(){var a=0,b=0,c={x:null,y:null},d={x:null,y:null};return this.chart.axes.forEach(function(a){"x"===a.position&&null===d.x?d.x=a._hasTimeField()?this.chart._xPixels():a._origin:"y"===a.position&&null===d.y&&(d.y=a._hasTimeField()?this.chart._yPixels()+this.chart._heightPixels():a._origin)},this),this.chart.axes.forEach(function(e){"x"!==e.position||this.x.hidden?"y"!==e.position||this.y.hidden||(this._deepMatch(e)&&(0===b?c.x=d.x:1===b&&(c.x=this.chart._xPixels()+this.chart._widthPixels())),b+=1):(this._deepMatch(e)&&(0===a?c.y=d.y:1===a&&(c.y=this.chart._yPixels())),a+=1)},this),c},this._getTooltipFontSize=function(){var a;return a=this.tooltipFontSize&&"auto"!==this.tooltipFontSize.toString().toLowerCase()?isNaN(this.tooltipFontSize)?this.tooltipFontSize:this.tooltipFontSize+"px":(this.chart._heightPixels()/35>10?this.chart._heightPixels()/35:10)+"px"},this._isStacked=function(){return this.stacked&&(this.x._hasCategories()||this.y._hasCategories())},this.addEventHandler=function(a,b){this._eventHandlers.push({event:a,handler:b})},this.addOrderRule=function(a,b){this._orderRules.push({ordering:a,desc:b})},this.getTooltipText=function(a){var b=[];return null!==this.categoryFields&&void 0!==this.categoryFields&&this.categoryFields.length>0&&this.categoryFields.forEach(function(c,d){null!==c&&void 0!==c&&null!==a.aggField[d]&&void 0!==a.aggField[d]&&b.push(c+(a.aggField[d]!==c?": "+a.aggField[d]:""))},this),this.x&&this.x._getTooltipText(b,a),this.y&&this.y._getTooltipText(b,a),this.z&&this.z._getTooltipText(b,a),this.c&&this.c._getTooltipText(b,a),b.filter(function(a,c){return b.indexOf(a)===c})}},b.storyboard=function(a,b){null!==b&&void 0!==b&&(b=[].concat(b)),this.chart=a,this.categoryFields=b,this.autoplay=!0,this.frameDuration=3e3,this.storyLabel=null,this.onTick=null,this.fontSize="10px",this.fontFamily="sans-serif",this._frame=0,this._animationTimer=null,this._categories=[],this._cachedCategoryFields=[],this._orderRules=[],this._drawText=function(a){if(null===this.storyLabel||void 0===this.storyLabel){var b=(this.chart,0);this.chart.axes.forEach(function(a){"x"===a.position&&(b+=1)},this),this.storyLabel=this.chart._group.append("text").attr("x",this.chart._xPixels()+.01*this.chart._widthPixels()).attr("y",this.chart._yPixels()+(this.chart._heightPixels()/35>10?this.chart._heightPixels()/35:10)*(b>1?1.25:-1))}this.storyLabel.transition().duration(.2*a).ease(this.chart.ease).attr("opacity",0),this.storyLabel.transition().delay(.2*a).ease(this.chart.ease).attr("class","dimple-storyboard-label").text(this.categoryFields.join("\\")+": "+this.getFrameValue()).transition().duration(.8*a).attr("opacity",1)},this._getCategories=function(){return this._categoryFields!==this._cachedCategoryFields&&(this._categories=[],this.chart._getAllData().forEach(function(a){var b=-1,c="";null!==this.categoryFields&&(this.categoryFields.forEach(function(b,d){d>0&&(c+="/"),c+=a[b]},this),b=this._categories.indexOf(c),-1===b&&(this._categories.push(c),b=this._categories.length-1))},this),this._cachedCategoryFields=this._categoryFields),this._categories},this._getFontSize=function(){var a;return a=this.fontSize&&"auto"!==this.fontSize.toString().toLowerCase()?isNaN(this.fontSize)?this.fontSize:this.fontSize+"px":(this.chart._heightPixels()/35>10?this.chart._heightPixels()/35:10)+"px"},this._goToFrameIndex=function(a){this._frame=a%this._getCategories().length,this.chart.draw(this.frameDuration/2)},this.addOrderRule=function(a,b){this._orderRules.push({ordering:a,desc:b})},this.getFrameValue=function(){var a=null;return this._frame>=0&&this._getCategories().length>this._frame&&(a=this._getCategories()[this._frame]),a},this.goToFrame=function(a){if(this._getCategories().length>0){var b=this._getCategories().indexOf(a);this._goToFrameIndex(b)}},this.pauseAnimation=function(){null!==this._animationTimer&&(window.clearInterval(this._animationTimer),this._animationTimer=null)},this.startAnimation=function(){null===this._animationTimer&&(null!==this.onTick&&this.onTick(this.getFrameValue()),this._animationTimer=window.setInterval(function(a){return function(){a._goToFrameIndex(a._frame+1),null!==a.onTick&&a.onTick(a.getFrameValue()),a._drawText(a.frameDuration/2)}}(this),this.frameDuration))},this.stopAnimation=function(){null!==this._animationTimer&&(window.clearInterval(this._animationTimer),this._animationTimer=null,this._frame=0)}},b.aggregateMethod.avg=function(a,b){return a.value=null===a.value||void 0===a.value?0:parseFloat(a.value),a.count=null===a.count||void 0===a.count?1:parseFloat(a.count),b.value=null===b.value||void 0===b.value?0:parseFloat(b.value),b.count=null===b.count||void 0===b.count?1:parseFloat(b.count),(a.value*a.count+b.value*b.count)/(a.count+b.count)},b.aggregateMethod.count=function(a,b){return a.count=null===a.count||void 0===a.count?0:parseFloat(a.count),b.count=null===b.count||void 0===b.count?0:parseFloat(b.count),a.count+b.count},b.aggregateMethod.max=function(a,b){return a.value=null===a.value||void 0===a.value?0:parseFloat(a.value),b.value=null===b.value||void 0===b.value?0:parseFloat(b.value),a.value>b.value?a.value:b.value},b.aggregateMethod.min=function(a,b){return parseFloat(null===a.value?b.value:parseFloat(a.value)<parseFloat(b.value)?a.value:b.value)},b.aggregateMethod.sum=function(a,b){return a.value=null===a.value||void 0===a.value?0:parseFloat(a.value),b.value=null===b.value||void 0===b.value?0:parseFloat(b.value),a.value+b.value},b.plot.area={stacked:!0,grouped:!0,supportedAxes:["x","y","c"],draw:function(c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G=d._positionData,H=[],I=null,J="dimple-series-"+c.series.indexOf(d),K=d.x._hasCategories()||d.y._hasCategories()?0:1,L=!1,M={},N=[],O=[],P={},Q=function(a){c.svg.selectAll("path.dimple-line").classed("active",!1).filter(function(){return this.id===a}).classed("active",!0)},R=function(c,d){return null===d&&(d=!1),function(e,f,g,h){var i=e.aggField[0];Q(i),a.select(f).style("opacity",1),b._showPointTooltip(e,f,g,h,c,d)}},S=function(){return function(c,d,e,f){f&&(a.select(d).style("opacity",0),b._removeTooltip(c,d,e,f))}},T=function(a){b._drawMarkers(a,c,d,e,J,L,R(a),S(a))},U=function(a,e){var f;return"step"===d.interpolation&&d[a]._hasCategories()?(f=b._helpers[a](e,c,d)+("y"===a?b._helpers.height(e,c,d):0),d[a].categoryFields.length<2&&(f+=("y"===a?1:-1)*b._helpers[a+"Gap"](c,d))):f=b._helpers["c"+a](e,c,d),parseFloat(f.toFixed(1))},V=function(b,c){return a.svg.line().x(function(a){return d.x._hasCategories()||!c?a.x:d.x[c]}).y(function(a){return d.y._hasCategories()||!c?a.y:d.y[c]}).interpolate(b)},W=function(a,b){return parseFloat(a)-parseFloat(b)},X=function(a,b){return parseFloat(a.x)-parseFloat(b.x)},Y=function(a,b,c){var d,e,f=b[b.length-1],g=9999,h=f;for(d=0;d<a.length;d+=1)(a[d].x!==f.x||a[d].y!==f.y)&&(e=180-Math.atan2(a[d].x-f.x,a[d].y-f.y)*(180/Math.PI),e>c&&g>e&&(h=a[d],g=e));return b.push(h),g},Z=function(){if(null!==c.svg.select("path.active").node()){var b,e,f=a.mouse(this)[0],g=null,h=c.svg.select("path.active").attr("id"),i=c.svg.selectAll("circle.dimple-"+h)[0].length,j=a.select("g.dimple-gridline").node().getBBox().width,k=parseInt(j/(2*(i-1)),10),l=a.mouse(this);b=c.svg.selectAll("circle.dimple-"+h)[0].filter(function(a){return g=parseInt(a.attributes.cx.value,10),g>=f-k&&f+k>=g}),l[0]+=40,b.length&&(C!==b[0]||null===C?(C=b[0],e=parseInt(C.attributes.cx.value,10)+1,c.svg.select(".verticalLine").attr("transform",function(){return"translate("+e+",0)"}),c.svg.select(".timePointSelect").attr("transform",function(){return"translate("+(e-9)+",0)"}),a.selectAll("circle:not(.stayVisible)").style("opacity",0),R(l)(C.__data__,C,c,d),P.data=C.__data__,P.point=C,P.chart=c,P.series=d):R(l,!0)(C.__data__,C,c,d))}},_=function(b){!b&&window.event&&(b=event);var e,f=b.relatedTarget||event.toElement;0===$("div.chart-tooltip").has(f).length?(S({data:[]})(P.data,P.point,P.chart,P.series),Q(!1),C=null,c.svg.select(".verticalLine").attr("transform",function(){return"translate(-1,0)"}),c.svg.select(".timePointSelect").attr("transform",function(){return"translate(-16,0)"}),c.svg.select("circle:not(.stayVisible)").attr("opacity",0)):(e=a.mouse(this),e[0]+=a.mouse($("div.chart-tooltip:visible")[0])[0],R(a.mouse(this))(C.__data__,C,c,d))},ab=function(a,b,d,e){var f=c.svg.select("g").append("g").attr("class",e).on("click",a).attr("transform","translate("+b+", 0)");f.append("rect").attr("width","16").attr("height","16").attr("fill","#666666").attr("style","cursor: pointer;"),f.append("text").attr({x:8,y:12}).attr("style","cursor: pointer;text-anchor: middle; font-family: sans-serif; font-size: 13px;").attr("fill","white").text(d)},bb=function(){a.select(".timePointSelect.remove").node()&&(c.svg.selectAll("path.dimple-line").classed("grayed",!1),c.svg.select("g.timePointSelect.remove").remove(),c.svg.select("line.selected").remove(),c.svg.selectAll("circle").style("opacity",0).classed("stayVisible",!1),"function"==typeof d.setTimePoint&&d.setTimePoint(null))},cb=function(){if(bb(),!this.classList.contains("remove")){var a=P.point.cx.baseVal.value,b=c.svg.selectAll("circle")[0].filter(function(a){return P.point.cx.baseVal.value===a.cx.baseVal.value});c.svg.selectAll(b).style("opacity",1).classed("stayVisible",!0),c.svg.selectAll("path.dimple-line").classed("grayed",!0),c.svg.select("svg > g").append("line").attr({x1:a,y1:16,x2:a,y2:E.height-F.height}).attr("stroke","lightgray").attr("class","selected"),ab(bb,a-8,"x","timePointSelect remove"),d.setTimePoint(P.data.lana["time.interval"])}};for(B=function(){return(B=d.updateTooltipPosition?d.updateTooltipPosition.bind(d):function(a){return a})()},c.timePointSelectable&&c.series[0].clearTimePoints&&(bb(),c.series[0].clearTimePoints=!1),f="step"===d.interpolation?"step-after":d.interpolation,o=b._getSeriesOrder(d.data||c.data,d),d.c&&(d.x._hasCategories()&&d.y._hasMeasure()||d.y._hasCategories()&&d.x._hasMeasure())&&(L=!0),d.x._hasCategories()?(z="x",A="y"):d.y._hasCategories()&&(z="y",A="x"),g=0;g<G.length;g+=1){for(j=[],l=-1,i=K;i<G[g].aggField.length;i+=1)j.push(G[g].aggField[i]);for(k=b._createClass(j),i=0;i<H.length;i+=1)if(H[i].keyString===k){l=i;break}-1===l&&(l=H.length,H.push({key:j,keyString:k,color:"white",data:[],points:[],area:{},entry:{},exit:{},group:z&&G[g][z+"Field"]&&G[g][z+"Field"].length>=2?G[g][z+"Field"][0]:"All"})),H[l].data.push(G[g])}for(o&&H.sort(function(a,c){return b._arrayIndexCompare(o,a.key,c.key)}),g=0;g<H.length;g+=1){for(H[g].data.sort(b._getSeriesSortPredicate(c,d,o)),h=0;h<H[g].data.length;h+=1)H[g].points.push({x:U("x",H[g].data[h]),y:U("y",H[g].data[h])}),z&&(M[H[g].group]||(M[H[g].group]={}),M[H[g].group][H[g].points[H[g].points.length-1][z]]=d[A]._origin);p=H[g].points,"step"===d.interpolation&&p.length>1&&z&&(d.x._hasCategories()?(p.push({x:2*p[p.length-1].x-p[p.length-2].x,y:p[p.length-1].y}),M[H[g].group][p[p.length-1][z]]=d[A]._origin):d.y._hasCategories()&&(p=[{x:p[0].x,y:2*p[0].y-p[1].y}].concat(p),M[H[g].group][p[0][z]]=d[A]._origin,H[g].points=p))}for(s in M)if(M.hasOwnProperty(s)){N[s]=[];for(t in M[s])M[s].hasOwnProperty(t)&&N[s].push(parseFloat(t));N[s].sort(W)}for(g=0;g<H.length;g+=1){if(p=H[g].points,u=H[g].group,q=[],O=[],L&&b._addGradient(H[g].key,"fill-area-gradient-"+H[g].keyString,d.x._hasCategories()?d.x:d.y,G,c,e,"fill"),N[u]&&N[u].length>0)for(h=0,i=0;h<N[u].length;h+=1)N[u][h]>=p[0][z]&&N[u][h]<=p[p.length-1][z]&&(r={},r[z]=N[u][h],r[A]=M[u][N[u][h]],q.push(r),p[i][z]>N[u][h]?O.push(r):(O.push(p[i]),M[H[g].group][N[u][h]]=p[i][A],i+=1));else if(d._orderRules&&d._orderRules.length>0)O=p.concat(p[0]);else{p=p.sort(X),O.push(p[0]),y=0;do y=Y(p,O,y);while(O.length<=p.length&&(O[0].x!==O[O.length-1].x||O[0].y!==O[O.length-1].y))}q=q.reverse(),v=V(f,"_previousOrigin")(O),w=V("step-after"===f?"step-before":"step-before"===f?"step-after":f,"_previousOrigin")(q),x=V("linear","_previousOrigin")(O),H[g].entry=v+(w&&w.length>0?"L"+w.substring(1):"")+(x&&x.length>0?"L"+x.substring(1,x.indexOf("L")):0),v=V(f)(O),w=V("step-after"===f?"step-before":"step-before"===f?"step-after":f)(q),x=V("linear")(O),H[g].update=v+(w&&w.length>0?"L"+w.substring(1):"")+(x&&x.length>0?"L"+x.substring(1,x.indexOf("L")):0),v=V(f,"_origin")(O),w=V("step-after"===f?"step-before":"step-before"===f?"step-after":f,"_origin")(q),x=V("linear","_origin")(O),H[g].exit=v+(w&&w.length>0?"L"+w.substring(1):"")+(x&&x.length>0?"L"+x.substring(1,x.indexOf("L")):0),H[g].color=c.getColor(H[g].key.length>0?H[g].key[H[g].key.length-1]:"All")}null!==c._tooltipGroup&&void 0!==c._tooltipGroup&&c._tooltipGroup.remove(),I=null===d.shapes||void 0===d.shapes?c._group.selectAll("."+J).data(H):d.shapes.data(H,function(a){return a.key}),I.enter().append("path").attr("id",function(a){return a.key}).attr("class",function(a){return J+" dimple-line "+a.keyString}).attr("d",function(a){return a.entry}).on("mouseenter",function(a){Q(a.key[0])}).call(function(){c.noFormats||this.attr("opacity",function(a){return L?1:a.color.opacity}).attr("fill",function(a){return L?"url(#fill-area-gradient-"+a.keyString+")":a.color.fill}).attr("stroke",function(a){return L?"url(#stroke-area-gradient-"+a.keyString+")":a.color.stroke}).attr("stroke-width",d.lineWeight)}).each(function(a){a.markerData=a.data,T(a)}),null!==c.svg.select("g.timePointSelect.remove")[0][0]&&(c.svg.selectAll("path.dimple-line").classed("grayed",!0),D=c.svg.select("circle.stayVisible").node().cx.baseVal.value,p=c.svg.selectAll("circle")[0].filter(function(a){return D===a.cx.baseVal.value}),c.svg.selectAll(p).style("opacity",1).classed("stayVisible",!0)),c.svg.select("line.verticalLine").node()||(c.svg.on("mousemove",Z).on("mouseleave",_),c.svg.select("path.dimple-line").on("mousemove",Z).on("mouseleave",_),E=c.svg.select("g").node().getBBox(),F=c.svg.select("g.dimple-axis").node().getBBox(),c.svg.select("g").append("line").attr({x1:-1,y1:E.y+("number"==typeof c.y?c.y:30)-(c.timePointSelectable?18:0),x2:-1,y2:E.height-F.height}).attr("stroke","lightgray").attr("class","verticalLine"),c.timePointSelectable&&ab(cb,-16,"+","timePointSelect")),m=c._handleTransition(I,e,c).attr("d",function(a){return a.update}).each(function(a){a.markerData=a.data,T(a)}),n=c._handleTransition(I.exit(),e,c).attr("d",function(a){return a.exit}).each(function(a){a.markerData=[],T(a)}),b._postDrawHandling(d,m,n,e),d.shapes=I}},b.plot.bar={stacked:!0,grouped:!1,supportedAxes:["x","y","c"],draw:function(a,c,d){var e,f,g,h,i,j=c._positionData,k=null,l=["dimple-series-"+a.series.indexOf(c),"dimple-bar"],m=!c._isStacked()&&c.x._hasMeasure(),n=!c._isStacked()&&c.y._hasMeasure(),o="none";c.x._hasCategories()&&c.y._hasCategories()?o="both":c.x._hasCategories()?o="x":c.y._hasCategories()&&(o="y"),k=null===c.shapes||void 0===c.shapes?a._group.selectAll("."+l.join(".")).data(j):c.shapes.data(j,function(a){return a.key}),k.enter().append("rect").attr("id",function(a){return a.key}).attr("class",function(a){var c=[];return c=c.concat(a.aggField),c=c.concat(a.xField),c=c.concat(a.yField),l.join(" ")+" "+b._createClass(c)}).attr("x",function(d){var e=c.x._previousOrigin;return"x"===o?e=b._helpers.x(d,a,c):"both"===o&&(e=b._helpers.cx(d,a,c)),e}).attr("y",function(d){var e=c.y._previousOrigin;return"y"===o?e=b._helpers.y(d,a,c):"both"===o&&(e=b._helpers.cy(d,a,c)),e}).attr("width",function(d){return"x"===o?b._helpers.width(d,a,c):0}).attr("height",function(d){return"y"===o?b._helpers.height(d,a,c):0}).attr("opacity",function(d){return b._helpers.opacity(d,a,c)}).on("mouseover",function(d){b._showBarTooltip(d,this,a,c)}).on("mouseleave",function(d){b._removeTooltip(d,this,a,c)}).call(function(){a.noFormats||this.attr("fill",function(d){return b._helpers.fill(d,a,c)}).attr("stroke",function(d){return b._helpers.stroke(d,a,c)})}),e=a._handleTransition(k,d,a,c).attr("x",function(d){return m?b._helpers.cx(d,a,c)-c.x.floatingBarWidth/2:b._helpers.x(d,a,c)}).attr("y",function(d){return n?b._helpers.cy(d,a,c)-c.y.floatingBarWidth/2:b._helpers.y(d,a,c)-(b._helpers.height(d,a,c)<4?4-b._helpers.height(d,a,c):1)}).attr("width",function(d){return m?c.x.floatingBarWidth:b._helpers.width(d,a,c)}).attr("height",function(d){return n?c.y.floatingBarWidth:Math.max(b._helpers.height(d,a,c),4)}).call(function(){a.noFormats||this.attr("fill",function(d){return b._helpers.fill(d,a,c)}).attr("stroke",function(d){return b._helpers.stroke(d,a,c)})}),f=a._handleTransition(k.exit(),d,a,c).attr("x",function(d){var e=c.x._origin;return"x"===o?e=b._helpers.x(d,a,c):"both"===o&&(e=b._helpers.cx(d,a,c)),e||0}).attr("y",function(d){var e=c.y._origin;return"y"===o?e=b._helpers.y(d,a,c):"both"===o&&(e=b._helpers.cy(d,a,c)),e||0}).attr("width",function(d){return"x"===o?b._helpers.width(d,a,c):0}).attr("height",function(d){return"y"===o?b._helpers.height(d,a,c):0}),b._postDrawHandling(c,e,f,d),c.shapes=k,0===a.svg.selectAll(".verticalLine")[0].length&&(g=a.svg.select("g"),h=g.node().getBBox(),i=a.svg.select("g.dimple-axis").node().getBBox(),g.insert("line",":first-child").attr({x1:-1,y1:h.y+("number"==typeof a.y?a.y:30)-(a.timePointSelectable?18:0),x2:-1,y2:h.height-i.height}).attr("stroke","lightgray").attr("class","verticalLine"))}},b.plot.bubble={stacked:!1,grouped:!1,supportedAxes:["x","y","z","c"],draw:function(a,c,d){var e,f,g=c._positionData,h=null,i=["dimple-series-"+a.series.indexOf(c),"dimple-bubble"];null!==a._tooltipGroup&&void 0!==a._tooltipGroup&&a._tooltipGroup.remove(),h=null===c.shapes||void 0===c.shapes?a._group.selectAll("."+i.join(".")).data(g):c.shapes.data(g,function(a){return a.key}),h.enter().append("circle").attr("id",function(a){return a.key}).attr("class",function(a){var c=[];return c=c.concat(a.aggField),c=c.concat(a.xField),c=c.concat(a.yField),c=c.concat(a.zField),i.join(" ")+" "+b._createClass(c)}).attr("cx",function(d){return c.x._hasCategories()?b._helpers.cx(d,a,c):c.x._previousOrigin}).attr("cy",function(d){return c.y._hasCategories()?b._helpers.cy(d,a,c):c.y._previousOrigin}).attr("r",0).attr("opacity",function(d){return b._helpers.opacity(d,a,c)}).on("mouseover",function(d){b._showPointTooltip(d,this,a,c)}).on("mouseleave",function(d){b._removeTooltip(d,this,a,c)}).call(function(){a.noFormats||this.attr("fill",function(d){return b._helpers.fill(d,a,c)}).attr("stroke",function(d){return b._helpers.stroke(d,a,c)})}),e=a._handleTransition(h,d,a,c).attr("cx",function(d){return b._helpers.cx(d,a,c)}).attr("cy",function(d){return b._helpers.cy(d,a,c)}).attr("r",function(d){return b._helpers.r(d,a,c)}).call(function(){a.noFormats||this.attr("fill",function(d){return b._helpers.fill(d,a,c)}).attr("stroke",function(d){return b._helpers.stroke(d,a,c)})}),f=a._handleTransition(h.exit(),d,a,c).attr("r",0).attr("cx",function(d){return c.x._hasCategories()?b._helpers.cx(d,a,c):c.x._origin}).attr("cy",function(d){return c.y._hasCategories()?b._helpers.cy(d,a,c):c.y._origin}),b._postDrawHandling(c,e,f,d),c.shapes=h}},b.plot.line={stacked:!1,grouped:!0,supportedAxes:["x","y","c"],draw:function(c,d,e){var f,g,h,i,j,k,l,m,n,o,p=d._positionData,q=[],r=null,s="dimple-series-"+c.series.indexOf(d),t=d.x._hasCategories()||d.y._hasCategories()?0:1,u=!1,v=[],w=function(){return function(a,c,d,e){if(e.disableLineMarkers!==!0){var f=d.lineData.filter(function(b){return b.key[0]===a.aggField[0]});b._tooltipWithLine.setActiveLine.bind(b._tooltipWithLine)(f[0])}}},x=function(){return function(a,c,d,e){e&&b._removeTooltip(a,c,d,e)}},y=function(a){b._drawMarkers(a,c,d,e,s,u,w(a),x(a))},z=function(a,e){var f;return"step"===d.interpolation&&d[a]._hasCategories()?(d.barGap=0,d.clusterBarGap=0,f=b._helpers[a](e,c,d)+("y"===a?b._helpers.height(e,c,d):0)):f=b._helpers["c"+a](e,c,d),parseFloat(f.toFixed(1))},A=function(b,c){return a.svg.line().x(function(a){return d.x._hasCategories()||!c?a.x:d.x[c]}).y(function(a){return d.y._hasCategories()||!c?a.y:d.y[c]}).interpolate(b)};for(f="step"===d.interpolation?"step-after":d.interpolation,o=b._getSeriesOrder(d.data||c.data,d),d.c&&(d.x._hasCategories()&&d.y._hasMeasure()||d.y._hasCategories()&&d.x._hasMeasure())&&(u=!0),g=0;g<p.length;g+=1){for(j=[],l=-1,i=t;i<p[g].aggField.length;i+=1)j.push(p[g].aggField[i]);for(k=b._createClass(j),i=0;i<q.length;i+=1)if(q[i].keyString===k){l=i;break}-1===l&&(l=q.length,q.push({key:j,keyString:k,color:"white",data:[],markerData:[],points:[],line:{},entry:{},exit:{}})),q[l].data.push(p[g])}for(q.map(function(a){v.push(a.keyString)}),o&&q.sort(function(a,c){return b._arrayIndexCompare(o,a.key,c.key)}),g=0;g<q.length;g+=1){for(q[g].data.sort(b._getSeriesSortPredicate(c,d,o)),u&&b._addGradient(q[g].key,"fill-line-gradient-"+q[g].keyString,d.x._hasCategories()?d.x:d.y,p,c,e,"fill"),h=0;h<q[g].data.length;h+=1)q[g].points.push({x:z("x",q[g].data[h]),y:z("y",q[g].data[h])});"step"===d.interpolation&&q[g].points.length>1&&(d.x._hasCategories()?q[g].points.push({x:2*q[g].points[q[g].points.length-1].x-q[g].points[q[g].points.length-2].x,y:q[g].points[q[g].points.length-1].y}):d.y._hasCategories()&&(q[g].points=[{x:q[g].points[0].x,y:2*q[g].points[0].y-q[g].points[1].y}].concat(q[g].points))),q[g].entry=A(f,"_previousOrigin")(q[g].points),q[g].update=A(f)(q[g].points),q[g].exit=A(f,"_origin")(q[g].points),q[g].color=c.getColor(q[g].key.length>0?q[g].key[q[g].key.length-1]:"All")}r=null===d.shapes||void 0===d.shapes?c._group.selectAll("."+s).data(q):d.shapes.data(q,function(a){return a.key}),c.showMarkers===!0&&(d.lineMarkers=!0),r.enter().append("path").attr("id",function(a){return a.key}).attr("class",function(a){return s+" dimple-line "+a.keyString}).attr("d",function(a){return a.entry}).call(function(){c.noFormats||this.attr("opacity",function(a){return u?1:a.color.opacity}).attr("fill","none").attr("stroke",function(a){return u?"url(#fill-line-gradient-"+a.keyString+")":a.color.stroke}).attr("stroke-width",d.lineWeight)}).each(function(a){a.markerData=a.data,y(a)}),c.lineData=q;var B=b._tooltipWithLine.init.bind(b._tooltipWithLine);B(c,d,y),m=c._handleTransition(r,0,c).attr("d",function(a){return a.update}).each(function(a){a.markerData=a.data,y(a)}).on("mouseenter",function(a){b._tooltipWithLine.setActiveLine.bind(b._tooltipWithLine)(a)}),n=c._handleTransition(r.exit(),e,c).attr("d",function(a){return a.exit}).each(function(a){a.markerData=[],y(a)}),b._postDrawHandling(d,m,n,e),d.shapes=r}},b._addGradient=function(a,b,c,d,e,f,g){var h=[].concat(a),i=e._group.select("#"+b),j=[],k=c.position+"Field",l=!0,m=[];d.forEach(function(a){-1===j.indexOf(a[k])&&a.aggField.join("_")===h.join("_")&&j.push(a[k])},this),j=j.sort(function(a,b){return c._scale(a)-c._scale(b)}),null===i.node()&&(l=!1,i=e._group.append("linearGradient").attr("id",b).attr("gradientUnits","userSpaceOnUse").attr("x1","x"===c.position?c._scale(j[0])+e._widthPixels()/j.length/2:0).attr("y1","y"===c.position?c._scale(j[0])-e._heightPixels()/j.length/2:0).attr("x2","x"===c.position?c._scale(j[j.length-1])+e._widthPixels()/j.length/2:0).attr("y2","y"===c.position?c._scale(j[j.length-1])-e._heightPixels()/j.length/2:0)),j.forEach(function(a,b){var c={},e=0;for(e=0;e<d.length;e+=1)if(d[e].aggField.join("_")===h.join("_")&&d[e][k].join("_")===a.join("_")){c=d[e];break}m.push({offset:Math.round(b/(j.length-1)*100)+"%",color:c[g]})},this),l?e._handleTransition(i.selectAll("stop").data(m),f,e).attr("offset",function(a){return a.offset}).attr("stop-color",function(a){return a.color}):i.selectAll("stop").data(m).enter().append("stop").attr("offset",function(a){return a.offset}).attr("stop-color",function(a){return a.color})},b._arrayIndexCompare=function(a,b,c){var d,e,f,g,h,i;for(e=0;e<a.length;e+=1){for(g=!0,h=!0,i=[].concat(a[e]),f=0;f<b.length;f+=1)g=g&&b[f]===i[f];for(f=0;f<c.length;f+=1)h=h&&c[f]===i[f];if(g&&h){d=0;break}if(g){d=-1;break}if(h){d=1;break}}return d},b._createClass=function(a){var b,c=[],d=function(a){var b=a.charCodeAt(0),c="-";return b>=65&&90>=b&&(c=a.toLowerCase()),c};if(a.length>0)for(b=0;b<a.length;b+=1)c.push("dimple-"+a[b].toString().replace(/[^a-z0-9]/g,d));else c=["dimple-all"];return c.join(" ")},b._drawMarkerBacks=function(c,d,e,f,g){var h,i,j=["dimple-marker-back",g,c.keyString];e.lineMarkers&&(h=null===e._markerBacks||void 0===e._markerBacks||void 0===e._markerBacks[c.keyString]?d._group.selectAll("."+j.join(".")).data(c.markerData):e._markerBacks[c.keyString].data(c.markerData,function(a){return a.key}),h.enter().append("circle").attr("id",function(a){return a.key}).attr("class",function(a){var c=[];return e.x._hasCategories()&&(c=c.concat(a.xField)),e.y._hasCategories()&&(c=c.concat(a.yField)),b._createClass(c)+" "+j.join(" ")}).attr("cx",function(a){return e.x._hasCategories()?b._helpers.cx(a,d,e):e.x._previousOrigin}).attr("cy",function(a){return e.y._hasCategories()?b._helpers.cy(a,d,e):e.y._previousOrigin}).attr("r",0).attr("fill","white").attr("stroke","none"),d._handleTransition(h,f,d).attr("cx",function(a){return b._helpers.cx(a,d,e)}).attr("cy",function(a){return b._helpers.cy(a,d,e)}).attr("r",2+e.lineWeight),i=d._handleTransition(h.exit(),f,d).attr("cx",function(a){return e.x._hasCategories()?b._helpers.cx(a,d,e):e.x._origin}).attr("cy",function(a){return e.y._hasCategories()?b._helpers.cy(a,d,e):e.y._origin}).attr("r",0),0===f?i.remove():i.each("end",function(){a.select(this).remove()}),(void 0===e._markerBacks||null===e._markerBacks)&&(e._markerBacks={}),e._markerBacks[c.keyString]=h)},b._drawMarkers=function(c,d,e,f,g,h,i,j){var k,l,m=["dimple-marker",g,c.keyString];b._drawMarkerBacks(c,d,e,f,g),k=null===e._markers||void 0===e._markers||void 0===e._markers[c.keyString]?d._group.selectAll("."+m.join(".")).data(c.markerData):e._markers[c.keyString].data(c.markerData,function(a){return a.key}),k.enter().append("circle").attr("id",function(a){return a.key}).attr("class",function(a){var c=[];return e.x._hasCategories()&&(c=c.concat(a.xField)),e.y._hasCategories()&&(c=c.concat(a.yField)),b._createClass(c)+" "+m.join(" ")}).on("mouseover",function(a){i(a,this,d,e)}).on("mouseleave",function(a){j(a,this,d,e)}).attr("cx",function(a){return e.x._hasCategories()?b._helpers.cx(a,d,e):e.x._previousOrigin}).attr("cy",function(a){return e.y._hasCategories()?b._helpers.cy(a,d,e):e.y._previousOrigin}).attr("r",0).attr("opacity",e.lineMarkers||c.data.length<2?c.color.opacity:0).call(function(){d.noFormats||this.attr("fill","white").style("stroke-width",e.lineWeight).attr("stroke",function(a){return h?b._helpers.fill(a,d,e):c.color.stroke})}),d._handleTransition(k,f,d).attr("cx",function(a){return b._helpers.cx(a,d,e)}).attr("cy",function(a){return b._helpers.cy(a,d,e)}).attr("r",2+e.lineWeight).call(function(){d.noFormats||this.attr("fill","white").style("stroke-width",e.lineWeight).attr("stroke",function(a){return h?b._helpers.fill(a,d,e):c.color.stroke})}),l=d._handleTransition(k.exit(),f,d).attr("cx",function(a){return e.x._hasCategories()?b._helpers.cx(a,d,e):e.x._origin}).attr("cy",function(a){return e.y._hasCategories()?b._helpers.cy(a,d,e):e.y._origin}).attr("r",0),0===f?l.remove():l.each("end",function(){a.select(this).remove()}),(void 0===e._markers||null===e._markers)&&(e._markers={}),e._markers[c.keyString]=k},b._getOrderedList=function(a,c,d){var e,f=[],g=[],h=[].concat(c),i=[].concat(c),j=[];return null!==d&&void 0!==d&&(j=j.concat(d)),j=j.concat({ordering:h,desc:!1}),j.forEach(function(b){var c;if("function"==typeof b.ordering)for(c in a[0])a[0].hasOwnProperty(c)&&-1===i.indexOf(c)&&i.push(c);else b.ordering instanceof Array||i.push(b.ordering)},this),e=b._rollUp(a,h,i),j.length>=1&&(j.forEach(function(a){var b=null===a.desc||void 0===a.desc?!1:a.desc,c=a.ordering,d=[],e="string"==typeof c?c:null,g=function(a){var b,c=0;for(b=0;b<a.length;b+=1){if(isNaN(a[b])){c=0;break}c+=parseFloat(a[b])}return c},i=function(a,b){var c=0,d=g(a),e=g(b);return isNaN(d)||0===d||isNaN(e)||0===e?isNaN(Date.parse(a[0]))||isNaN(Date.parse(b[0]))?a[0]<b[0]?c=-1:a[0]>b[0]&&(c=1):c=Date.parse(a[0])-Date.parse(b[0]):c=parseFloat(d)-parseFloat(e),c};"function"==typeof c?f.push(function(a,d){return(b?-1:1)*c(a,d)}):c instanceof Array?(c.forEach(function(a){d.push([].concat(a).join("|"))},this),f.push(function(a,c){var e,f,g,i="",j="";for(g=0;g<h.length;g+=1)g>0&&(i+="|",j+="|"),i+=a[h[g]],j+=c[h[g]];return e=d.indexOf(i),f=d.indexOf(j),e=0>e?b?-1:d.length:e,f=0>f?b?-1:d.length:f,(b?-1:1)*(e-f)})):f.push(function(a,c){var d=0;return void 0!==a[e]&&void 0!==c[e]&&(d=i([].concat(a[e]),[].concat(c[e]))),(b?-1:1)*d})}),e.sort(function(a,b){for(var c=0,d=0;c<f.length&&0===d;)d=f[c](a,b),c+=1;return d}),e.forEach(function(a){var b,c=[];if(1===h.length)g.push(a[h[0]]);else{for(b=0;b<h.length;b+=1)c.push(a[h[b]]);g.push(c)}},this)),g},b._getSeriesOrder=function(a,c){var d=[].concat(c._orderRules),e=c.categoryFields,f=[];return null!==e&&void 0!==e&&e.length>0&&(null!==c.c&&void 0!==c.c&&c.c._hasMeasure()&&d.push({ordering:c.c.measure,desc:!0}),c.x._hasMeasure()&&d.push({ordering:c.x.measure,desc:!0}),c.y._hasMeasure()&&d.push({ordering:c.y.measure,desc:!0}),f=b._getOrderedList(a,e,d)),f},b._getSeriesSortPredicate=function(a,c,d){return function(e,f){var g=0;return c.x._hasCategories()&&(g=b._helpers.cx(e,a,c)-b._helpers.cx(f,a,c)),0===g&&c.y._hasCategories()&&(g=b._helpers.cy(e,a,c)-b._helpers.cy(f,a,c)),0===g&&d&&(g=b._arrayIndexCompare(d,e.aggField,f.aggField)),g}},b._helpers={cx:function(a,c,d){var e=0;return e=null!==d.x.measure&&void 0!==d.x.measure?d.x._scale(a.cx):d.x._hasCategories()&&d.x.categoryFields.length>=2?d.x._scale(a.cx)+b._helpers.xGap(c,d)+(a.xOffset+.5)*(c._widthPixels()/d.x._max-2*b._helpers.xGap(c,d))*a.width:d.x._scale(a.cx)+c._widthPixels()/d.x._max/2},cy:function(a,c,d){var e=0;return e=null!==d.y.measure&&void 0!==d.y.measure?d.y._scale(a.cy):null!==d.y.categoryFields&&void 0!==d.y.categoryFields&&d.y.categoryFields.length>=2?d.y._scale(a.cy)-c._heightPixels()/d.y._max+b._helpers.yGap(c,d)+(a.yOffset+.5)*(c._heightPixels()/d.y._max-2*b._helpers.yGap(c,d))*a.height:d.y._scale(a.cy)-c._heightPixels()/d.y._max/2},r:function(a,b,c){var d=0,e=1;return null===c.z||void 0===c.z?d=c.radius&&"auto"!==c.radius?c.radius:5:(c.radius&&"auto"!==c.radius&&c.radius>1&&(e=c.radius/c.z._scale(c.z._max)),d=c.z._hasMeasure()?c.z._scale(a.r)*e:c.z._scale(b._heightPixels()/100)*e),d},xGap:function(a,b){var c=0;return(null===b.x.measure||void 0===b.x.measure)&&b.barGap>0&&(c=a._widthPixels()/b.x._max*(b.barGap>.99?.99:b.barGap)/2),c},xClusterGap:function(a,c,d){var e=0;return null!==d.x.categoryFields&&void 0!==d.x.categoryFields&&d.x.categoryFields.length>=2&&d.clusterBarGap>0&&!d.x._hasMeasure()&&(e=a.width*(c._widthPixels()/d.x._max-2*b._helpers.xGap(c,d))*(d.clusterBarGap>.99?.99:d.clusterBarGap)/2),e},yGap:function(a,b){var c=0;return(null===b.y.measure||void 0===b.y.measure)&&b.barGap>0&&(c=a._heightPixels()/b.y._max*(b.barGap>.99?.99:b.barGap)/2),c},yClusterGap:function(a,c,d){var e=0;return null!==d.y.categoryFields&&void 0!==d.y.categoryFields&&d.y.categoryFields.length>=2&&d.clusterBarGap>0&&!d.y._hasMeasure()&&(e=a.height*(c._heightPixels()/d.y._max-2*b._helpers.yGap(c,d))*(d.clusterBarGap>.99?.99:d.clusterBarGap)/2),e
},x:function(a,c,d){var e,f,g=0;return d.x._hasTimeField()?g=d.x._scale(a.x)-b._helpers.width(a,c,d)/2:null!==d.x.measure&&void 0!==d.x.measure?g=d.x._scale(a.x):(g=d.x._scale(a.x)+b._helpers.xGap(c,d)+a.xOffset*(b._helpers.width(a,c,d)+2*b._helpers.xClusterGap(a,c,d))+b._helpers.xClusterGap(a,c,d),b._helpers.width(a,c,d)>=40&&(e=d._positionData.length/d.x._max,f=2*b._helpers.xGap(c,d)+e*(b._helpers.width(a,c,d)+2*b._helpers.xClusterGap(a,c,d))+b._helpers.xClusterGap(a,c,d),g+=(c._widthPixels()/d.x._max-f)/2)),g},y:function(a,c,d){var e=0;return e=d.y._hasTimeField()?d.y._scale(a.y)-b._helpers.height(a,c,d)/2:null!==d.y.measure&&void 0!==d.y.measure?d.y._scale(a.y):d.y._scale(a.y)-c._heightPixels()/d.y._max+b._helpers.yGap(c,d)+a.yOffset*(b._helpers.height(a,c,d)+2*b._helpers.yClusterGap(a,c,d))+b._helpers.yClusterGap(a,c,d)},width:function(a,c,d){var e=0;return e=null!==d.x.measure&&void 0!==d.x.measure?Math.abs(d.x._scale(a.x<0?a.x-a.width:a.x+a.width)-d.x._scale(a.x)):d.x._hasTimeField()?d.x.floatingBarWidth:a.width*(c._widthPixels()/d.x._max-2*b._helpers.xGap(c,d))-2*b._helpers.xClusterGap(a,c,d),Math.min(e,40)},height:function(a,c,d){var e=0;return e=d.y._hasTimeField()?d.y.floatingBarWidth:null!==d.y.measure&&void 0!==d.y.measure?Math.abs(d.y._scale(a.y)-d.y._scale(a.y<=0?a.y+a.height:a.y-a.height)):a.height*(c._heightPixels()/d.y._max-2*b._helpers.yGap(c,d))-2*b._helpers.yClusterGap(a,c,d)},opacity:function(a,b,c){var d=0;return d=null!==c.c&&void 0!==c.c?a.opacity:b.getColor(a.aggField.slice(-1)[0]).opacity},fill:function(a,b,c){var d=0;return d=null!==c.c&&void 0!==c.c?a.fill:b.getColor(a.aggField.slice(-1)[0]).fill},stroke:function(a,b,c){var d=0;return d=null!==c.c&&void 0!==c.c?a.stroke:b.getColor(a.aggField.slice(-1)[0]).stroke},wrap:function(b,c){b.each(function(){for(var b,d=a.select(this),e=d.text().split(/\s+/).reverse(),f=[],g=0,h=1.1,i=d.attr("y"),j=parseFloat(d.attr("dy")),k=d.text(null).append("tspan").attr("x",0).attr("y",i).attr("dy",j+"em");b=e.pop();)f.push(b),k.text(f.join(" ")),k.node().getComputedTextLength()>c&&(f.pop(),k.text(f.join(" ")),f=[b],k=d.append("tspan").attr("x",0).attr("y",i).attr("dy",++g*h+j+"em").text(b))})},leaveEveryNth:function(a,b,c){var d=1;if(c>a*b)return d;for(d=25>=a?2:49>=a?3:73>=a?4:97>=a?6:8,1>b&&(b=1);a/d*b>c;){for(d++;24%d!==0&&(d++,!(d>400)););if(d>100)break}return d},bisectDate:function(){return a.bisector(function(a){return a.cx}).left}},b._parentHeight=function(a){var c=a.offsetHeight;return(0>=c||null===c||void 0===c)&&(c=a.clientHeight),(0>=c||null===c||void 0===c)&&(c=null===a.parentNode||void 0===a.parentNode?0:b._parentHeight(a.parentNode)),c},b._parentWidth=function(a){var c=a.offsetWidth;return(0>=c||null===c||void 0===c)&&(c=a.clientWidth),(0>=c||null===c||void 0===c)&&(c=null===a.parentNode||void 0===a.parentNode?0:b._parentWidth(a.parentNode)),c},b._parseXPosition=function(a,c){var d,e=0;return null!==a&&void 0!==a&&(d=a.toString().split(","),d.forEach(function(d){void 0!==d&&null!==d&&(isNaN(d)?"%"===d.slice(-1)?e+=b._parentWidth(c)*(parseFloat(d.slice(0,d.length-1))/100):"px"===d.slice(-2)?e+=parseFloat(d.slice(0,d.length-2)):e=a:e+=parseFloat(d))},this)),0>e&&(e=b._parentWidth(c)+e),e},b._parseYPosition=function(a,c){var d,e=0;return null!==a&&void 0!==a&&(d=a.toString().split(","),d.forEach(function(d){void 0!==d&&null!==d&&(isNaN(d)?"%"===d.slice(-1)?e+=b._parentHeight(c)*(parseFloat(d.slice(0,d.length-1))/100):"px"===d.slice(-2)?e+=parseFloat(d.slice(0,d.length-2)):e=a:e+=parseFloat(d))},this)),0>e&&(e=b._parentHeight(c)+e),e},b._postDrawHandling=function(b,c,d,e){0===e?(c.each(function(a,c){null!==b.afterDraw&&void 0!==b.afterDraw&&b.afterDraw(this,a,c)}),d.remove()):(c.each("end",function(a,c){null!==b.afterDraw&&void 0!==b.afterDraw&&b.afterDraw(this,a,c)}),d.each("end",function(){a.select(this).remove()}))},b._removeTooltip=function(a,b,c,d){"function"==typeof d.removeTooltip&&d.removeTooltip();var e=c.svg.select(".verticalLine");e&&e.style("transform","translate(-16px,0px)")},b._rollUp=function(a,b,c){var d=[];return b=null!==b&&void 0!==b?[].concat(b):[],a.forEach(function(a){var e=-1,f={},g=!0;d.forEach(function(c,d){-1===e&&(g=!0,b.forEach(function(b){g=g&&a[b]===c[b]},this),g&&(e=d))},this),-1!==e?f=d[e]:(b.forEach(function(b){f[b]=a[b]},this),d.push(f),e=d.length-1),c.forEach(function(c){-1===b.indexOf(c)&&(void 0===f[c]&&(f[c]=[]),f[c]=f[c].concat(a[c]))},this),d[e]=f},this),d},b._showBarTooltip=function(b,c,d,e){var f,g,h,i,j=0,k=30,l=a.select(c),m=parseFloat(l.attr("x")),n=parseFloat(l.attr("y")),o=parseFloat(l.attr("width")),p=parseFloat(l.attr("height")),q=0,r=250,s=0;null!==d._tooltipGroup&&void 0!==d._tooltipGroup&&d._tooltipGroup.remove(),d._tooltipGroup=d.svg.append("g"),m+o+j+k+r<parseFloat(d.svg.node().getBBox().width)?(h=m+o+j+k,i=n+p/2-(q-(s-j))/2):m-(j+k+r)>0?(h=m-(j+k+r),i=n+p/2-(q-(s-j))/2):n+p+q+k+j<parseFloat(d.svg.node().getBBox().height)?(h=m+o+j+k,i=n+p/2-(q-(s-j))/2):(h=m+o+j+k,i=n+p/2-(q-(s-j))/2),"function"==typeof e.showTooltip&&(g=[h,i],e.showTooltip(b,c,d,e,g),f=d.svg.select(".verticalLine"),f&&f.style("transform","translate("+(m+(o+4)/2)+"px,0px)"))},b._showPointTooltip=function(a,b,c,d,e,f){var g,h,i,j,k=0,l=30,m=4,n=0,o=350,p=0;e&&(g=e[0],h=e[1]),g+m+k+l+o<parseFloat(c.svg.select("g").node().getBBox().width)?(i=g+m+k+l,j=h-(n-(p-k))/2):g-m-(k+l+o)>0?(i=g-m-(k+l+o)-30,j=h-(n-(p-k))/2):h+m+n+l+k<parseFloat(c.svg.node().getBBox().height)?(i=g+m+k+l,j=h-(n-(p-k))/2):(i=g+m+k+l,j=h-(n-(p-k))/2),"function"==typeof d.showTooltip&&(f===!0?d.updateTooltipPosition([i,j]):d.showTooltip(a,[i,j]))},b._timePoint={selectedLine:null,timePointRemove:null,chart:null,series:null,grid:null,xAxis:null,verticalLine:null,create:function(a,c,d,e,f,g,h,i){var j,k;return j=a.svg.select("g"),this.chart=a,this.series=c,this.drawMarkers=i,null===this.grid&&(this.grid=j.node().getBBox(),this.xAxis=this.chart.svg.select("g.dimple-axis").node().getBBox()),null===b._tooltipWithLine.verticalLine&&(b._tooltipWithLine.verticalLine=j.insert("line",":first-child").attr({x1:-1,y1:this.grid.y+("number"==typeof this.chart.y?this.chart.y:30)-(this.chart.timePointSelectable?18:0),x2:-1,y2:this.grid.height-this.xAxis.height}).attr("stroke","lightgray").attr("class","verticalLine")),k=this.chart.svg.select("g").append("g"),k.attr("class",g).on("click",d.bind(this)).style("transform","translate("+e+"px, 0px)").attr("data-i",h),k.append("rect").attr("width","16").attr("height","16").attr("fill","#666666").attr("style","cursor: pointer;"),k.append("text").attr({x:8,y:12}).attr("style","cursor: pointer;text-anchor: middle; font-family: sans-serif; font-size: 13px;").attr("fill","white").text(f),k},deselect:function(){this.chart.svg.selectAll("path.dimple-line").classed("grayed",!1),this.chart.svg.selectAll("circle.dimple-marker").classed("grayed",!1),a.select(".timePointSelect.remove").node()&&"function"==typeof this.series.setTimePoint&&this.series.setTimePoint(null),this.timePointRemove&&(this.timePointRemove.remove(),this.timePointRemove=null),this.selectedLine&&(this.selectedLine.remove(),this.selectedLine=null),this.series.lineMarkers||this.chart.svg.selectAll("circle.dimple-marker").style("opacity",0)},select:function(){if(this.deselect(),!a.select(".timePointSelect.remove").node()){var c=b._tooltipWithLine.verticalLine.attr("data-i"),d=this.chart.lineData[0].points[c].x,e=null,f=this;this.chart.lineData.forEach(function(a,c){var g,h=f.series.x._scale.invert(d),i=b._helpers.bisectDate()(f.chart.lineData[c].data,h,1),j=a.data[parseInt(i,10)-1],k=a.data[parseInt(i,10)],l=a.keyString.replace(/\s/g,"-");void 0!==j&&void 0!==k&&(h-j.cx>k.cx-h?g=k:(g=j,i=parseInt(i,10)-1),f.series.lineMarkers?(e=f.chart.svg.selectAll("circle.dimple-marker."+l),e.classed("grayed",!0),e.filter(function(a,b){return b===i}).classed("grayed",!1)):(a.markerData=[a.data[0],g],f.drawMarkers(a),f.chart.svg.selectAll("circle.dimple-marker."+l).style("opacity",1),f.chart.svg.select("circle.dimple-marker."+l).style("opacity",0)))}),this.chart.svg.selectAll("path.dimple-line").classed("grayed",!0),this.selectedLine=this.chart.svg.select("svg > g").insert("line",":first-child").attr({x1:d,y1:16,x2:d,y2:this.grid.height-this.xAxis.height}).attr("stroke","lightgray").attr("class","selected"),this.timePointRemove=this.create(this.chart,this.series,this.deselect,d-8,"x","timePointSelect remove",c,this.drawMarkers),this.series.setTimePoint(this.chart.lineData[0].data[c].origData["time.interval"])}}},b._tooltipWithLine={timePointSelect:null,verticalLine:null,line:null,marker:null,series:null,activeLine:null,chart:null,xCoordinate:null,setActiveLine:function(a){null===this.marker||this.series.lineMarkers||this.marker.style("opacity",0);var b,c=!1;a.key?(this.activeLine=a,c=this.activeLine.key[0],b="string"==typeof c&&c.indexOf(" ")>0?c.replace(/\s/g,"-"):c,this.series.lineMarkers||(this.marker=this.chart.svg.select("circle.dimple-marker.dimple-"+b))):this.activeLine={},this.chart.svg.selectAll("path.dimple-line").classed("active",!1).filter(function(){return this.id===c.toString()}).classed("active",!0)},init:function(a,b,c){this.chart=a,this.series=b,this.drawMarkers=c,this.timePointSelect=null,this.verticalLine=null,this.line=null,this.marker=null,this.activeLine=null,this.xCoordinate=null,this.initMouseEvents(),this.initVerticalLine(),this.initxCoordinate()},initMouseEvents:function(){this.chart.svg.on("mousemove",null).on("mouseleave",null),this.chart.svg.on("mousemove",this.show.bind(this)).on("mouseleave",this.hide.bind(this))},initVerticalLine:function(){this.chart.timePointSelectable&&this.chart.series[0].clearTimePoints&&(b._timePoint.deselect.bind(b._timePoint),this.chart.series[0].clearTimePoints=!1),0===this.chart.svg.selectAll(".verticalLine")[0].length?(b._tooltipWithLine.verticalLine=null,this.chart.timePointSelectable&&(this.timePointSelect=b._timePoint.create.bind(b._timePoint)(this.chart,this.series,b._timePoint.select,-16,"+","timePointSelect",0,this.drawMarkers.bind(b.plot.line)))):(this.verticalLine=this.chart.svg.select(".verticalLine"),this.chart.timePointSelectable&&(this.timePointSelect=this.chart.svg.select(".timePointSelect")))},initxCoordinate:function(){null!==this.chart.svg.select("g.timePointSelect.remove")[0][0]&&(i=this.chart.svg.select("g.timePointSelect.remove").attr("data-i"),this.xCoordinate=this.chart.lineData[0].points[i].x)},show:function(){if(!this.chart.lineData||0!==this.chart.lineData.length){var c,d,e,f,g,h;this.line=this.activeLine&&this.activeLine.keyString?this.activeLine:this.chart.lineData[0],c=this.series.x._scale.invert(a.mouse(this.chart.svg[0][0])[0]),d=b._helpers.bisectDate()(this.line.data,c,1),0===d?g=this.line.data[d]:d>=this.line.data.length?(d=this.line.data.length-1,g=this.line.data[d]):(e=this.line.data[d-1],f=this.line.data[d],c-e.cx>f.cx-c?g=f:(g=e,d--)),this.xCoordinate=this.series.x._scale(g.cx)+1,this.activeLine&&this.activeLine.keyString&&(h=a.mouse(this.chart.svg[0][0]),h[0]+=40,$("div.tooltip:visible").length>0||b._showPointTooltip(g,null,this.chart,this.series,h),this.updatePosition(h),null!==this.marker&&this.marker.attr("cx",this.activeLine.points[d].x).attr("cy",this.activeLine.points[d].y).style("opacity",1),this.xCoordinate=this.activeLine.points[d].x+1),this.verticalLine&&this.verticalLine.style("transform","translate("+this.xCoordinate+"px,0px)").attr("data-i",d),this.timePointSelect&&this.timePointSelect.style("transform","translate("+(this.xCoordinate-9)+"px,0px)")}},hide:function(c){!c&&window.event&&(c=event);var d,e=c.relatedTarget||event.toElement;0===$("div.chart-tooltip:visible").has(e).length?(b._removeTooltip(null,null,this.chart,this.series),this.activeLine=null,this.chart.svg.selectAll("path.dimple-line").classed("active",!1),this.verticalLine&&this.verticalLine.style("transform","translate(-1px,0px)"),this.timePointSelect&&this.timePointSelect.style("transform","translate(-16px,0px)"),this.marker&&!this.series.lineMarkers&&this.marker.style("opacity",0)):(d=a.mouse(this.chart.svg[0][0]),d[0]+=a.mouse($("div.chart-tooltip:visible")[0])[0],this.updatePosition(d))},updatePosition:function(a){var b;return(b=this.series.updateTooltipPosition?this.series.updateTooltipPosition.bind(this.series):function(a){return a})(a)}},b.filterData=function(a,b,c){var d=a;return null!==b&&null!==c&&(null!==c&&void 0!==c&&(c=[].concat(c)),d=[],a.forEach(function(a){null===a[b]?d.push(a):c.indexOf([].concat(a[b]).join("/"))>-1&&d.push(a)},this)),d},b.getUniqueValues=function(a,b){var c=[];return null!==b&&void 0!==b&&(b=[].concat(b),a.forEach(function(a){var d="";b.forEach(function(b,c){c>0&&(d+="/"),d+=a[b]},this),-1===c.indexOf(d)&&c.push(d)},this)),c},b.newSvg=function(b,c,d){var e=null;if((null===b||void 0===b)&&(b="body"),e=a.select(b),e.empty())throw"The '"+b+"' selector did not match any elements.  Please prefix with '#' to select by id or '.' to select by class";return e.append("svg").attr("width",c).attr("height",d)},b});